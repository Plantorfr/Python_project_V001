â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    EXPLICATION COMPLÃˆTE DU CODE
                  Ligne par ligne, simple et claire
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


                        TABLE DES MATIÃˆRES

1. email_parser.py      - Comment on lit un fichier .eml
2. detection_rules.py   - Comment on dÃ©tecte les anomalies
3. risk_scorer.py       - Comment on calcule le score
4. exporters.py         - Comment on sauvegarde les rÃ©sultats
5. __main__.py          - Comment tout s'orchestre


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“§ FICHIER 1 : email_parser.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RÃ”LE : Lire un fichier .eml et en extraire les informations importantes

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
LIGNE PAR LIGNE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
import re
from bs4 import BeautifulSoup
```

EXPLICATION :
- `import re` = On importe le module regex (expressions rÃ©guliÃ¨res)
- `from bs4 import BeautifulSoup` = On importe BeautifulSoup pour parser HTML


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
class AnalyseurEmail:
```

EXPLICATION :
- On crÃ©e une CLASSE (= un moule pour crÃ©er des objets)
- C'est comme une recette : elle dÃ©finit comment analyser un email


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def __init__(self, chemin_fichier: str):
    self.chemin_fichier = chemin_fichier
    self.contenu_brut = ""
    self.entetes = {}
    self.corps = ""
```

EXPLICATION :
- `__init__` = Le CONSTRUCTEUR (ce qui se passe quand on crÃ©e l'objet)
- `self` = L'objet lui-mÃªme (comme "moi" pour une personne)
- `chemin_fichier: str` = Le paramÃ¨tre attendu (type = chaÃ®ne de texte)

Variables d'instance (stockÃ©es dans l'objet) :
- `self.chemin_fichier` = OÃ¹ se trouve le fichier Ã  lire
- `self.contenu_brut` = Le texte complet du fichier (vide au dÃ©but)
- `self.entetes` = Dictionnaire pour stocker les en-tÃªtes (From, To, etc.)
- `self.corps` = Le message lui-mÃªme (vide au dÃ©but)

ANALOGIE :
C'est comme prÃ©parer un dossier vide avant de le remplir avec les infos


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def charger_email(self):
    with open(self.chemin_fichier, 'r', encoding='utf-8') as fichier:
        self.contenu_brut = fichier.read()
```

EXPLICATION :
- `def charger_email(self):` = DÃ©finition d'une mÃ©thode (fonction dans la classe)
- `with open(...)` = Ouvre le fichier de maniÃ¨re sÃ©curisÃ©e (se ferme automatiquement)
- `'r'` = Mode lecture ("read")
- `encoding='utf-8'` = Format de caractÃ¨res (pour accents, Ã©mojis, etc.)
- `as fichier` = Donne un nom court pour manipuler le fichier
- `fichier.read()` = Lit TOUT le contenu du fichier
- `self.contenu_brut = ...` = Stocke le contenu dans la variable

ANALOGIE :
Tu ouvres une lettre, tu lis tout ce qu'il y a dedans, et tu le mets de cÃ´tÃ©


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def extraire_entetes(self):
    pattern = r'^(From|To|Subject|Date|Reply-To):\s*(.+)$'
    matches = re.findall(pattern, self.contenu_brut, re.MULTILINE | re.IGNORECASE)
    
    for nom, valeur in matches:
        self.entetes[nom.capitalize()] = valeur.strip()
```

EXPLICATION DÃ‰TAILLÃ‰E :

1. `pattern = r'^(From|To|Subject|Date|Reply-To):\s*(.+)$'`
   - `r'...'` = Raw string (les \ ne sont pas Ã©chappÃ©s)
   - `^` = DÃ©but de ligne
   - `(From|To|...)` = Groupe 1 : Capture UN de ces mots
   - `:` = Deux-points littÃ©ral
   - `\s*` = ZÃ©ro ou plusieurs espaces
   - `(.+)` = Groupe 2 : Capture tout le reste de la ligne
   - `$` = Fin de ligne

2. `re.findall(pattern, texte, flags)`
   - Cherche TOUTES les occurrences du pattern dans le texte
   - `re.MULTILINE` = ^ et $ fonctionnent sur chaque ligne
   - `re.IGNORECASE` = Insensible Ã  la casse (From = from)
   - Retourne une LISTE de TUPLES : [('From', 'alice@...'), ('To', 'bob@...')]

3. `for nom, valeur in matches:`
   - Boucle sur chaque rÃ©sultat trouvÃ©
   - DÃ©compose le tuple en 2 variables : nom et valeur

4. `self.entetes[nom.capitalize()] = valeur.strip()`
   - `.capitalize()` = Met la premiÃ¨re lettre en majuscule
   - `.strip()` = Retire les espaces en dÃ©but/fin
   - Stocke dans le dictionnaire : {'From': 'alice@...', 'To': 'bob@...'}

EXEMPLE CONCRET :
Texte : "From: alice@example.com\nTo: bob@example.com"
RÃ©sultat : {'From': 'alice@example.com', 'To': 'bob@example.com'}


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def extraire_corps(self):
    parties = self.contenu_brut.split('\n\n', 1)
    
    if len(parties) > 1:
        self.corps = parties[1].strip()
    
    if '<html' in self.corps.lower() or '<body' in self.corps.lower():
        soup = BeautifulSoup(self.corps, 'html.parser')
        self.corps = soup.get_text(separator=' ', strip=True)
```

EXPLICATION DÃ‰TAILLÃ‰E :

1. `parties = self.contenu_brut.split('\n\n', 1)`
   - `.split('\n\n', 1)` = Coupe le texte en 2 parties au premier double saut de ligne
   - Dans un email : en-tÃªtes + ligne vide + corps
   - Le `1` = Coupe maximum 1 fois (donc max 2 parties)

2. `if len(parties) > 1:`
   - VÃ©rifie qu'il y a bien 2 parties (en-tÃªtes ET corps)

3. `self.corps = parties[1].strip()`
   - `parties[1]` = La deuxiÃ¨me partie (index 1 car on commence Ã  0)
   - `.strip()` = Retire les espaces/sauts de ligne en dÃ©but/fin

4. `if '<html' in self.corps.lower() or '<body' in self.corps.lower():`
   - `.lower()` = Met en minuscules pour la comparaison
   - DÃ©tecte si le corps contient du HTML

5. `soup = BeautifulSoup(self.corps, 'html.parser')`
   - CrÃ©e un objet BeautifulSoup qui parse le HTML
   - `'html.parser'` = Utilise le parser HTML standard de Python

6. `self.corps = soup.get_text(separator=' ', strip=True)`
   - `.get_text()` = Extrait TOUT le texte (retire les balises HTML)
   - `separator=' '` = SÃ©pare les Ã©lÃ©ments par un espace
   - `strip=True` = Retire les espaces inutiles

EXEMPLE :
HTML : "<p>Bonjour <b>monde</b>!</p>"
RÃ©sultat : "Bonjour monde !"


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def obtenir_donnees_completes(self) -> dict:
    self.charger_email()
    self.extraire_entetes()
    self.extraire_corps()
    
    return {
        'expediteur': self.entetes.get('From', 'Inconnu'),
        'destinataire': self.entetes.get('To', 'Inconnu'),
        'sujet': self.entetes.get('Subject', ''),
        'date': self.entetes.get('Date', ''),
        'reply_to': self.entetes.get('Reply-to', ''),
        'corps': self.corps
    }
```

EXPLICATION :

1. `-> dict:` = Type hint : cette fonction retourne un dictionnaire

2. ExÃ©cution dans l'ordre :
   - `self.charger_email()` = Lit le fichier
   - `self.extraire_entetes()` = Extrait les en-tÃªtes
   - `self.extraire_corps()` = Extrait le corps

3. `return { ... }` = Retourne un dictionnaire

4. `self.entetes.get('From', 'Inconnu')`
   - `.get(clÃ©, dÃ©faut)` = RÃ©cupÃ¨re la valeur OU la valeur par dÃ©faut si inexistant
   - Si 'From' n'existe pas, retourne 'Inconnu'

RÃ‰SULTAT :
Un dictionnaire bien structurÃ© avec toutes les infos de l'email


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def parser_email(chemin_fichier: str) -> dict:
    analyseur = AnalyseurEmail(chemin_fichier)
    return analyseur.obtenir_donnees_completes()
```

EXPLICATION :
- Fonction UTILITAIRE (raccourci pratique)
- CrÃ©e un objet AnalyseurEmail
- Appelle la mÃ©thode complÃ¨te
- Retourne le rÃ©sultat

C'est comme un bouton "tout faire automatiquement"

UTILISATION :
```python
donnees = parser_email('spam.eml')
print(donnees['expediteur'])
```


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” FICHIER 2 : detection_rules.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RÃ”LE : Analyser l'email et dÃ©tecter les comportements suspects

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
import re
```

EXPLICATION :
On importe regex pour chercher des patterns (URLs, domaines, mots-clÃ©s)


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
class MoteurDetection:
    def __init__(self):
        self.anomalies = []
```

EXPLICATION :
- Classe pour dÃ©tecter les anomalies
- `self.anomalies = []` = Liste vide pour stocker les problÃ¨mes trouvÃ©s


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def analyser_email(self, donnees_email: dict) -> list:
    self.anomalies = []
    
    self._verifier_expediteur(donnees_email)
    self._detecter_urls_suspectes(donnees_email)
    self._detecter_mots_cles_phishing(donnees_email)
    
    return self.anomalies
```

EXPLICATION :
- `donnees_email: dict` = ReÃ§oit le dictionnaire de email_parser
- `-> list` = Retourne une liste

1. RÃ©initialise la liste des anomalies
2. ExÃ©cute 3 vÃ©rifications (les mÃ©thodes commenÃ§ant par _)
3. Retourne toutes les anomalies trouvÃ©es

NOTE : `_nom` = Convention Python pour mÃ©thode "privÃ©e" (usage interne)


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def _ajouter_anomalie(self, severite: str, description: str):
    self.anomalies.append({
        'severite': severite,
        'description': description
    })
```

EXPLICATION :
- MÃ©thode utilitaire pour ajouter une anomalie
- `.append()` = Ajoute Ã  la fin de la liste
- Stocke un dictionnaire avec la sÃ©vÃ©ritÃ© et la description

EXEMPLE :
```python
self._ajouter_anomalie('haute', 'URL avec IP dÃ©tectÃ©e')
# Ajoute : {'severite': 'haute', 'description': 'URL avec IP dÃ©tectÃ©e'}
```


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def _verifier_expediteur(self, donnees: dict):
    expediteur = donnees.get('expediteur', '')
    reply_to = donnees.get('reply_to', '')
    
    match_domaine = re.search(r'@([\w\.-]+)', expediteur)
    
    if match_domaine:
        domaine = match_domaine.group(1).lower()
        
        if domaine.count('-') > 2 or sum(c.isdigit() for c in domaine) > 3:
            self._ajouter_anomalie(
                'moyenne',
                f"Domaine suspect : {domaine}"
            )
    
    if reply_to and reply_to != expediteur:
        self._ajouter_anomalie(
            'haute',
            f"Reply-To diffÃ©rent : {reply_to}"
        )
```

EXPLICATION DÃ‰TAILLÃ‰E :

1. RÃ©cupÃ¨re l'expÃ©diteur et le reply-to

2. `re.search(r'@([\w\.-]+)', expediteur)`
   - Cherche le pattern dans l'expÃ©diteur
   - `@` = Arobase littÃ©ral
   - `([\w\.-]+)` = Capture : lettres/chiffres/point/tiret (1 ou +)
   - Retourne un objet Match ou None

3. `if match_domaine:` = Si on a trouvÃ© un match

4. `match_domaine.group(1)` = RÃ©cupÃ¨re le groupe 1 (le domaine)
   Exemple : "alice@evil-bank.com" â†’ "evil-bank.com"

5. `.lower()` = Met en minuscules

6. `domaine.count('-')` = Compte le nombre de tirets
   - Si > 2 tirets : suspect (ex: evil-bank-2024.com)

7. `sum(c.isdigit() for c in domaine)` = Compte les chiffres
   - `for c in domaine` = Pour chaque caractÃ¨re
   - `c.isdigit()` = True si c'est un chiffre
   - `sum(...)` = Somme des True (1) et False (0)
   - Si > 3 chiffres : suspect (ex: bank2024.com)

8. `if reply_to and reply_to != expediteur:`
   - `reply_to` = VÃ©rifie que reply_to existe (pas vide)
   - `reply_to != expediteur` = VÃ©rifie qu'ils sont diffÃ©rents
   - C'est une technique de phishing courante


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def _detecter_urls_suspectes(self, donnees: dict):
    corps = donnees.get('corps', '')
    
    urls = re.findall(r'https?://[^\s<>"]+', corps, re.IGNORECASE)
    
    for url in urls:
        if re.search(r'(bit\.ly|tinyurl|t\.co|goo\.gl)', url, re.IGNORECASE):
            self._ajouter_anomalie(
                'moyenne',
                f"URL raccourcie : {url}"
            )
        
        if re.search(r'\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}', url):
            self._ajouter_anomalie(
                'haute',
                f"URL avec IP : {url}"
            )
```

EXPLICATION DÃ‰TAILLÃ‰E :

1. `re.findall(r'https?://[^\s<>"]+', corps, re.IGNORECASE)`
   - `findall` = Trouve TOUTES les occurrences
   - `https?` = http OU https (? = optionnel)
   - `://` = LittÃ©ral
   - `[^\s<>"]+` = 1 ou + caractÃ¨res qui ne sont PAS espace, <, >, "
   - Retourne une LISTE d'URLs

   Exemple : "Visitez http://evil.com et https://malware.ru"
   RÃ©sultat : ['http://evil.com', 'https://malware.ru']

2. `for url in urls:` = Pour chaque URL trouvÃ©e

3. Premier test : URL raccourcie
   - `(bit\.ly|tinyurl|t\.co|goo\.gl)` = Un de ces services
   - `\.` = Point littÃ©ral (Ã©chappÃ©)
   - Si trouvÃ© â†’ anomalie moyenne

4. DeuxiÃ¨me test : Adresse IP
   - `\d{1,3}` = 1 Ã  3 chiffres
   - `\.` = Point littÃ©ral
   - Pattern complet : xxx.xxx.xxx.xxx
   - Si trouvÃ© â†’ anomalie haute (trÃ¨s suspect)


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def _detecter_mots_cles_phishing(self, donnees: dict):
    sujet = donnees.get('sujet', '').lower()
    corps = donnees.get('corps', '').lower()
    texte = f"{sujet} {corps}"
    
    mots_suspects = [
        'urgent', 'action requise', 'compte bloquÃ©', 'cliquez ici',
        'vÃ©rifiez', 'confirmer', 'mot de passe', 'gagnant'
    ]
    
    mots_trouves = []
    
    for mot in mots_suspects:
        if re.search(rf'\b{re.escape(mot)}\b', texte, re.IGNORECASE):
            mots_trouves.append(mot)
    
    if len(mots_trouves) >= 2:
        self._ajouter_anomalie(
            'haute',
            f"Mots-clÃ©s phishing : {', '.join(mots_trouves)}"
        )
```

EXPLICATION DÃ‰TAILLÃ‰E :

1. `.lower()` = Met en minuscules pour comparaison insensible Ã  la casse

2. `f"{sujet} {corps}"` = F-string : combine sujet et corps avec un espace

3. `mots_suspects = [...]` = Liste des mots Ã  chercher

4. `mots_trouves = []` = Liste vide pour stocker ce qu'on trouve

5. Boucle sur chaque mot suspect :

   `rf'\b{re.escape(mot)}\b'`
   - `r` = Raw string
   - `f` = F-string (permet d'insÃ©rer {mot})
   - `\b` = Word boundary (frontiÃ¨re de mot)
   - `re.escape(mot)` = Ã‰chappe les caractÃ¨res spÃ©ciaux dans le mot
   - Exemple : "action requise" devient r'\baction requise\b'

   POURQUOI \b ?
   Pour chercher le MOT EXACT, pas Ã  l'intÃ©rieur d'un autre mot
   "urgent" matchera dans "C'est urgent" mais PAS dans "chirurgien"

6. `if re.search(...)` = Si le mot est trouvÃ©
   - `.append(mot)` = Ajoute Ã  la liste

7. `if len(mots_trouves) >= 2:`
   - Si au moins 2 mots suspects â†’ anomalie haute
   - Plus il y a de mots, plus c'est suspect

8. `', '.join(mots_trouves)` = Joint les mots avec ", "
   Exemple : ['urgent', 'cliquez ici'] â†’ "urgent, cliquez ici"


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def detecter_anomalies(donnees_email: dict) -> list:
    moteur = MoteurDetection()
    return moteur.analyser_email(donnees_email)
```

EXPLICATION :
Fonction utilitaire (raccourci) comme dans email_parser
CrÃ©e un moteur et lance l'analyse


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š FICHIER 3 : risk_scorer.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RÃ”LE : Calculer un score de risque basÃ© sur les anomalies

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
class CalculateurRisque:
    POINTS = {
        'faible': 10,
        'moyenne': 25,
        'haute': 40
    }
```

EXPLICATION :
- `POINTS` = Attribut de CLASSE (partagÃ© par toutes les instances)
- Dictionnaire : Ã  chaque sÃ©vÃ©ritÃ© correspond un nombre de points
- Ã‰crit en MAJUSCULES = convention pour constante


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def calculer_score(self, anomalies: list) -> dict:
    score = 0
    
    for anomalie in anomalies:
        severite = anomalie.get('severite', 'faible')
        score += self.POINTS.get(severite, 10)
    
    score = min(score, 100)
    
    if score == 0:
        niveau = 'minimal'
    elif score < 30:
        niveau = 'faible'
    elif score < 60:
        niveau = 'moyen'
    else:
        niveau = 'critique'
    
    return {
        'score': score,
        'niveau': niveau,
        'nb_anomalies': len(anomalies)
    }
```

EXPLICATION DÃ‰TAILLÃ‰E :

1. `score = 0` = Initialisation Ã  zÃ©ro

2. `for anomalie in anomalies:` = Pour chaque anomalie

3. `anomalie.get('severite', 'faible')` 
   - RÃ©cupÃ¨re la sÃ©vÃ©ritÃ©
   - Si n'existe pas, utilise 'faible' par dÃ©faut

4. `score += self.POINTS.get(severite, 10)`
   - `+=` = Addition et assignation (score = score + points)
   - `self.POINTS.get(severite, 10)` = RÃ©cupÃ¨re les points
   - Si sÃ©vÃ©ritÃ© inconnue, ajoute 10 par dÃ©faut

   EXEMPLE :
   Anomalie 1 : sÃ©vÃ©ritÃ© 'haute' â†’ +40 points
   Anomalie 2 : sÃ©vÃ©ritÃ© 'moyenne' â†’ +25 points
   Score total : 65 points

5. `score = min(score, 100)`
   - `min(a, b)` = Retourne le plus petit des deux
   - Plafonne le score Ã  100 maximum
   - Si score = 150 â†’ devient 100

6. `if ... elif ... else` = Structure conditionnelle

   - `score == 0` â†’ niveau = 'minimal'
   - `score < 30` â†’ niveau = 'faible'
   - `score < 60` â†’ niveau = 'moyen'
   - sinon â†’ niveau = 'critique'

   EXEMPLE :
   score = 45 â†’ niveau = 'moyen' (car 30 â‰¤ 45 < 60)

7. Retourne un dictionnaire avec 3 infos :
   - Le score numÃ©rique (0-100)
   - Le niveau textuel
   - Le nombre d'anomalies


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def evaluer_risque(anomalies: list) -> dict:
    calc = CalculateurRisque()
    return calc.calculer_score(anomalies)
```

EXPLICATION :
Fonction utilitaire (raccourci)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’¾ FICHIER 4 : exporters.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RÃ”LE : Sauvegarder les rÃ©sultats dans un fichier texte

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def exporter_rapport(donnees_email: dict, anomalies: list, evaluation: dict, 
                     fichier: str = 'rapport.txt'):
```

EXPLICATION :
- Fonction (pas de classe, c'est plus simple ici)
- `fichier: str = 'rapport.txt'` = ParamÃ¨tre avec VALEUR PAR DÃ‰FAUT
  Si on ne prÃ©cise rien, utilisera 'rapport.txt'


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
with open(fichier, 'w', encoding='utf-8') as f:
```

EXPLICATION :
- `open(fichier, 'w', ...)` 
  - `'w'` = Mode Ã©criture ("write")
  - ATTENTION : Ã©crase le fichier s'il existe dÃ©jÃ 
  - Autres modes : 'r' (lecture), 'a' (ajout)
- `encoding='utf-8'` = Pour accents et caractÃ¨res spÃ©ciaux
- `as f` = Nom court pour manipuler le fichier
- `with` = Gestion automatique (ferme le fichier Ã  la fin)


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
f.write("=" * 60 + "\n")
f.write("RAPPORT D'ANALYSE EMAIL\n")
f.write("=" * 60 + "\n\n")
```

EXPLICATION :
- `f.write(...)` = Ã‰crit dans le fichier
- `"=" * 60` = RÃ©pÃ¨te le caractÃ¨re = 60 fois
  RÃ©sultat : "============================================..."
- `"\n"` = Saut de ligne (retour Ã  la ligne)
- `"\n\n"` = Double saut de ligne (ligne vide)

RÃ‰SULTAT DANS LE FICHIER :
```
============================================================
RAPPORT D'ANALYSE EMAIL
============================================================

```


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
f.write(f"De      : {donnees_email.get('expediteur', 'N/A')}\n")
```

EXPLICATION :
- F-string : `f"...{variable}..."`
- InsÃ¨re la valeur de la variable dans le texte
- `.get('expediteur', 'N/A')` = Si n'existe pas, affiche "N/A"
- Les espaces aprÃ¨s "De" servent Ã  ALIGNER les valeurs

RÃ‰SULTAT :
```
De      : alice@example.com
Ã€       : bob@example.com
Sujet   : Test
```


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
if anomalies:
    for i, anom in enumerate(anomalies, 1):
        f.write(f"{i}. [{anom.get('severite', '?')}] {anom.get('description', '')}\n")
else:
    f.write("Aucune anomalie dÃ©tectÃ©e.\n")
```

EXPLICATION DÃ‰TAILLÃ‰E :

1. `if anomalies:` = Si la liste N'est PAS vide
   - Liste vide = False
   - Liste avec Ã©lÃ©ments = True

2. `enumerate(anomalies, 1)`
   - Parcourt la liste EN NUMÃ‰ROTANT
   - `1` = Commence Ã  1 (pas 0)
   - Retourne : (numÃ©ro, Ã©lÃ©ment)

   EXEMPLE :
   ```python
   liste = ['a', 'b', 'c']
   for i, lettre in enumerate(liste, 1):
       print(i, lettre)
   # Affiche :
   # 1 a
   # 2 b
   # 3 c
   ```

3. `f"{i}. [{anom.get('severite', '?')}] {anom.get('description', '')}\n"`
   - `{i}` = Le numÃ©ro
   - `{anom.get('severite', '?')}` = La sÃ©vÃ©ritÃ©
   - `{anom.get('description', '')}` = La description

   RÃ‰SULTAT :
   ```
   1. [haute] URL avec IP dÃ©tectÃ©e
   2. [moyenne] Domaine suspect
   ```

4. `else:` = Si la liste est vide
   - Ã‰crit "Aucune anomalie dÃ©tectÃ©e."


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
return fichier
```

EXPLICATION :
- Retourne le nom du fichier crÃ©Ã©
- Utile pour confirmer que Ã§a a fonctionnÃ©


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¬ FICHIER 5 : __main__.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RÃ”LE : Point d'entrÃ©e du programme, orchestre tout

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
import sys
from email_parser import parser_email
from detection_rules import detecter_anomalies
from risk_scorer import evaluer_risque
from exporters import exporter_rapport
```

EXPLICATION :
- `import sys` = Module systÃ¨me (pour lire les arguments de ligne de commande)
- `from module import fonction` = Importe une fonction spÃ©cifique


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def afficher_banniere():
    print("\n" + "=" * 60)
    print("  ğŸ”’ ANALYSEUR EMAIL SIMPLIFIÃ‰")
    print("=" * 60 + "\n")
```

EXPLICATION :
- Fonction simple pour afficher le titre
- `print()` = Affiche Ã  l'Ã©cran
- `\n` au dÃ©but = Ligne vide avant


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def analyser_email(fichier: str):
    print(f"ğŸ“‚ Analyse de : {fichier}\n")
    
    print("[1/4] Parsing avec BeautifulSoup + Regex...")
    donnees = parser_email(fichier)
    print(f"      âœ“ ExpÃ©diteur : {donnees['expediteur']}")
```

EXPLICATION :

1. Messages pour l'utilisateur :
   - `print(f"ğŸ“‚ Analyse de : {fichier}\n")` = Affiche quel fichier
   - `\n` Ã  la fin = Ligne vide aprÃ¨s

2. `donnees = parser_email(fichier)`
   - Appelle la fonction du module email_parser
   - Stocke le rÃ©sultat dans `donnees`

3. `print(f"      âœ“ ExpÃ©diteur : {donnees['expediteur']}")`
   - Espaces au dÃ©but = Indentation pour lisibilitÃ©
   - `âœ“` = Symbole de validation
   - `donnees['expediteur']` = AccÃ¨s au dictionnaire


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
print("[2/4] DÃ©tection avec Regex...")
anomalies = detecter_anomalies(donnees)
print(f"      âœ“ {len(anomalies)} anomalies trouvÃ©es")
```

EXPLICATION :
- `len(anomalies)` = Nombre d'Ã©lÃ©ments dans la liste
- Affiche combien d'anomalies ont Ã©tÃ© trouvÃ©es


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
print("[3/4] Calcul du score...")
evaluation = evaluer_risque(anomalies)
print(f"      âœ“ Score : {evaluation['score']}/100")
```

EXPLICATION :
- Calcule le score
- Affiche le rÃ©sultat avec "/100" pour clartÃ©


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
print("[4/4] Export rapport...")
rapport = exporter_rapport(donnees, anomalies, evaluation)
print(f"      âœ“ Rapport : {rapport}")
```

EXPLICATION :
- CrÃ©e le fichier rapport
- Affiche le nom du fichier crÃ©Ã©


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
print("\n" + "=" * 60)
print(f"ğŸ¯ RÃ‰SULTAT : {evaluation['score']}/100 - {evaluation['niveau'].upper()}")
print("=" * 60 + "\n")
```

EXPLICATION :
- RÃ©sumÃ© final
- `.upper()` = Met en MAJUSCULES
  Exemple : "critique" â†’ "CRITIQUE"


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
def main():
    afficher_banniere()
    
    if len(sys.argv) < 2:
        print("Usage : python __main__.py fichier.eml\n")
        return
```

EXPLICATION DÃ‰TAILLÃ‰E :

1. `sys.argv` = Liste des arguments de ligne de commande
   - `sys.argv[0]` = Nom du script (__main__.py)
   - `sys.argv[1]` = Premier argument (le fichier .eml)

   EXEMPLE :
   Commande : `python __main__.py spam.eml`
   sys.argv = ['__main__.py', 'spam.eml']

2. `len(sys.argv)` = Nombre d'arguments

3. `if len(sys.argv) < 2:`
   - Si moins de 2 arguments (juste le nom du script)
   - Signifie que l'utilisateur n'a pas fourni le fichier

4. `print("Usage : ...")` = Affiche comment utiliser le programme

5. `return` = Sort de la fonction (arrÃªte le programme)


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
try:
    analyser_email(sys.argv[1])
except FileNotFoundError:
    print(f"âŒ Fichier introuvable : {sys.argv[1]}")
except Exception as e:
    print(f"âŒ Erreur : {e}")
```

EXPLICATION :

1. `try:` = Essaie d'exÃ©cuter ce code

2. `sys.argv[1]` = Le fichier fourni par l'utilisateur

3. `except FileNotFoundError:` = Si le fichier n'existe pas
   - Type d'erreur SPÃ‰CIFIQUE
   - Affiche un message personnalisÃ©

4. `except Exception as e:` = Pour TOUTES les autres erreurs
   - `as e` = Donne un nom Ã  l'erreur
   - `{e}` = Affiche le message d'erreur

EXEMPLE :
```
Fichier inexistant â†’ "âŒ Fichier introuvable : test.eml"
Autre erreur â†’ "âŒ Erreur : division by zero"
```


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

```python
if __name__ == "__main__":
    main()
```

EXPLICATION :

1. `__name__` = Variable spÃ©ciale Python
   - Vaut "__main__" si le fichier est EXÃ‰CUTÃ‰ directement
   - Vaut le nom du module si IMPORTÃ‰

2. Cette condition permet de faire :
   ```python
   # ExÃ©cution directe â†’ lance main()
   python __main__.py spam.eml
   
   # Import depuis un autre fichier â†’ ne lance PAS main()
   from __main__ import analyser_email
   ```

C'est une bonne pratique en Python !


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”„ LE FLUX COMPLET (Comment tout s'enchaÃ®ne)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Quand tu tapes : `python __main__.py spam.eml`

Ã‰TAPE 1 : __main__.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Python lit sys.argv = ['__main__.py', 'spam.eml']
2. VÃ©rifie qu'il y a bien 2 arguments âœ“
3. Lance analyser_email('spam.eml')


Ã‰TAPE 2 : email_parser.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4. CrÃ©e un objet AnalyseurEmail
5. Lit le fichier spam.eml
6. Extrait les en-tÃªtes avec regex
7. Extrait le corps (et nettoie le HTML avec BeautifulSoup si besoin)
8. Retourne un dictionnaire :
   {
     'expediteur': 'phishing@evil.com',
     'destinataire': 'victime@example.com',
     'sujet': 'URGENT',
     'corps': 'Cliquez ici...'
   }


Ã‰TAPE 3 : detection_rules.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
9. CrÃ©e un objet MoteurDetection
10. VÃ©rifie l'expÃ©diteur avec regex
11. Cherche les URLs avec regex
12. Cherche les mots-clÃ©s avec regex
13. Retourne une liste :
    [
      {'severite': 'haute', 'description': 'URL avec IP'},
      {'severite': 'moyenne', 'description': 'Domaine suspect'}
    ]


Ã‰TAPE 4 : risk_scorer.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
14. CrÃ©e un objet CalculateurRisque
15. Parcourt les anomalies
16. Additionne les points (haute=40 + moyenne=25 = 65)
17. DÃ©termine le niveau (65 â†’ 'critique')
18. Retourne :
    {
      'score': 65,
      'niveau': 'critique',
      'nb_anomalies': 2
    }


Ã‰TAPE 5 : exporters.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
19. Ouvre le fichier rapport.txt en Ã©criture
20. Ã‰crit les en-tÃªtes
21. Ã‰crit les infos de l'email
22. Ã‰crit le score
23. Ã‰crit la liste des anomalies
24. Ferme le fichier
25. Retourne 'rapport.txt'


Ã‰TAPE 6 : Affichage final
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
26. Affiche le rÃ©sumÃ© Ã  l'Ã©cran :
    ğŸ¯ RÃ‰SULTAT : 65/100 - CRITIQUE


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’¡ CONCEPTS CLÃ‰S UTILISÃ‰S
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. CLASSES ET OBJETS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Classe = Moule/Template
- Objet = Instance crÃ©Ã©e Ã  partir de la classe
- self = L'objet lui-mÃªme

Exemple :
```python
class Voiture:
    def __init__(self, couleur):
        self.couleur = couleur

ma_voiture = Voiture('rouge')  # CrÃ©e un objet
print(ma_voiture.couleur)       # AccÃ¨de Ã  l'attribut
```


2. MÃ‰THODES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Fonction Ã  l'intÃ©rieur d'une classe
- Premier paramÃ¨tre toujours `self`

```python
class Calculette:
    def additionner(self, a, b):
        return a + b

calc = Calculette()
resultat = calc.additionner(5, 3)  # 8
```


3. DICTIONNAIRES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Structure clÃ©: valeur
- AccÃ¨s rapide par clÃ©

```python
personne = {
    'nom': 'Alice',
    'age': 25
}
print(personne['nom'])          # Alice
print(personne.get('ville', 'Paris'))  # Paris (dÃ©faut)
```


4. LISTES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Collection ordonnÃ©e
- Index commence Ã  0

```python
fruits = ['pomme', 'banane', 'orange']
print(fruits[0])        # pomme
print(len(fruits))      # 3
fruits.append('kiwi')   # Ajoute Ã  la fin
```


5. F-STRINGS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Insertion de variables dans du texte

```python
nom = 'Bob'
age = 30
message = f"Bonjour {nom}, tu as {age} ans"
# RÃ©sultat : "Bonjour Bob, tu as 30 ans"
```


6. WITH (CONTEXT MANAGER)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Gestion automatique des ressources
- Ferme automatiquement les fichiers

```python
with open('fichier.txt', 'r') as f:
    contenu = f.read()
# Le fichier est automatiquement fermÃ© ici
```


7. TRY/EXCEPT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Gestion des erreurs

```python
try:
    resultat = 10 / 0
except ZeroDivisionError:
    print("Division par zÃ©ro !")
```


8. REGEX
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Recherche de patterns dans du texte

```python
import re
texte = "Mon email : bob@example.com"
match = re.search(r'@([\w\.-]+)', texte)
if match:
    print(match.group(1))  # example.com
```


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… RÃ‰SUMÃ‰ FINAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Le programme fait 4 choses :

1. ğŸ“§ LIT l'email (BeautifulSoup + Regex)
2. ğŸ” DÃ‰TECTE les anomalies (Regex)
3. ğŸ“Š CALCULE le score (Addition simple)
4. ğŸ’¾ SAUVEGARDE le rapport (Ã‰criture fichier)

Chaque fichier a UN rÃ´le clair.
Chaque fonction fait UNE chose.
C'est SIMPLE, CLAIR, et EFFICACE !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
